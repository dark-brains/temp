#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f client_assume_role.sh -o car_mac 
#endif

static  char data [] = 
#define      pswd_z	256
#define      pswd	((&data[39]))
	"\341\210\233\037\322\304\324\102\136\331\017\014\221\261\046\240"
	"\000\171\152\176\157\121\014\333\160\201\021\071\200\106\107\015"
	"\211\234\030\221\163\364\204\240\307\147\054\000\132\240\003\334"
	"\207\114\223\250\156\074\330\125\207\213\364\051\124\113\152\252"
	"\226\022\230\065\235\274\346\366\234\044\061\324\316\355\073\060"
	"\014\026\273\015\267\231\175\264\107\311\065\005\007\115\301\047"
	"\153\125\130\052\045\320\247\075\027\204\357\356\213\324\355\342"
	"\270\250\332\351\164\077\035\124\012\015\115\121\337\100\373\071"
	"\110\210\342\237\277\162\265\150\124\204\141\042\163\105\013\167"
	"\210\106\027\244\155\001\223\337\313\103\360\122\353\020\364\320"
	"\332\211\076\312\072\174\347\064\061\142\112\345\376\173\206\112"
	"\154\161\372\211\225\240\271\356\007\165\305\216\320\254\204\354"
	"\250\361\336\157\243\111\216\242\306\340\207\347\152\265\255\372"
	"\076\353\036\316\174\224\375\021\347\351\265\304\264\067\013\345"
	"\125\003\364\013\013\346\346\027\065\253\102\273\305\152\203\346"
	"\033\151\117\220\107\211\017\345\102\314\366\332\373\065\033\172"
	"\031\343\334\373\032\315\223\371\256\017\065\016\060\136\253\010"
	"\365\071\012\355\305\055\056\376\233\160\346\227\212\257\037\377"
	"\136\102\005\211\364\042\226\106\342\226\001\167\354\206\355\112"
	"\207\107\326\150\204\243\215\312\036\032\346\001\062\273\057\334"
	"\336\223\324\310\165\326\065\137\240\166\367\327\021\347\063\306"
	"\020\201\305\073\143\356\055\145\370\267\325\042\044\167\355\144"
	"\170"
#define      chk2_z	19
#define      chk2	((&data[354]))
	"\023\010\227\043\362\247\204\107\245\007\260\355\156\345\012\267"
	"\165\001\156\124\220"
#define      msg1_z	65
#define      msg1	((&data[384]))
	"\016\121\306\270\123\002\155\076\004\027\077\257\252\072\014\030"
	"\302\220\353\117\377\163\061\373\257\366\254\372\364\264\021\175"
	"\370\000\117\324\052\220\040\327\226\315\151\366\110\236\376\364"
	"\251\203\022\300\371\075\032\016\230\275\232\357\050\155\052\054"
	"\374\016\342\067\132\123\107\230\270\177\302\345\267\151\313\345"
	"\132\014\370\037"
#define      text_z	2565
#define      text	((&data[1090]))
	"\125\105\360\342\074\050\037\201\262\334\026\206\035\134\102\303"
	"\011\343\204\251\330\054\175\352\041\101\112\333\177\104\214\056"
	"\154\140\235\244\057\300\245\002\135\235\013\215\002\371\257\262"
	"\343\041\241\360\105\002\100\052\172\173\265\013\056\337\272\155"
	"\213\263\155\356\263\163\207\035\205\233\241\350\052\201\311\332"
	"\005\225\003\006\152\330\236\061\266\261\344\305\363\007\071\044"
	"\023\205\004\264\036\171\025\315\144\250\107\221\157\277\305\021"
	"\354\333\011\334\314\025\247\133\233\003\345\325\063\321\132\047"
	"\165\235\365\307\146\060\325\137\306\236\030\001\323\334\232\325"
	"\326\177\003\351\121\056\265\354\371\155\176\034\342\107\215\265"
	"\103\105\261\012\370\102\067\273\063\116\345\336\155\214\364\332"
	"\217\023\274\142\373\340\153\201\117\035\307\306\121\141\275\203"
	"\235\360\265\015\103\213\353\260\315\203\051\322\377\060\117\057"
	"\177\346\301\344\015\121\377\076\010\150\040\316\322\020\076\277"
	"\062\114\024\047\226\254\030\105\325\176\046\173\022\061\367\022"
	"\224\361\160\344\115\001\267\321\176\152\332\106\342\132\236\115"
	"\060\200\342\222\142\235\223\357\322\156\053\055\235\207\141\137"
	"\055\022\316\115\320\024\222\210\303\073\316\237\104\102\307\316"
	"\025\064\165\145\203\230\311\117\340\215\005\160\262\377\320\346"
	"\225\244\026\110\242\363\070\377\124\340\344\271\257\235\025\156"
	"\154\320\161\254\341\351\072\025\367\265\357\263\311\356\311\177"
	"\135\306\132\205\042\365\035\267\355\300\350\344\244\322\321\127"
	"\256\336\211\222\056\231\156\056\147\123\271\345\223\115\006\223"
	"\247\333\013\101\065\255\074\226\005\361\052\177\253\050\035\350"
	"\025\252\102\353\100\170\235\025\372\142\142\305\236\073\017\332"
	"\076\024\101\023\171\236\107\107\272\236\374\310\164\262\056\153"
	"\271\057\007\135\171\364\344\241\260\247\271\200\315\307\074\225"
	"\013\252\323\145\160\164\333\357\113\062\322\207\314\270\247\170"
	"\364\377\126\263\300\072\040\006\370\156\121\140\313\240\050\063"
	"\252\071\253\332\267\340\117\107\041\372\330\055\326\300\321\046"
	"\320\056\176\300\247\242\020\052\032\204\204\315\210\237\203\367"
	"\006\245\236\341\307\043\260\105\337\265\206\013\227\061\321\313"
	"\255\043\324\165\156\106\012\170\020\352\221\120\131\036\375\354"
	"\151\344\160\327\110\311\326\231\355\267\053\023\115\076\160\160"
	"\372\376\347\266\145\131\332\036\221\133\174\146\305\303\204\223"
	"\367\221\052\275\340\041\037\365\011\037\374\041\102\176\263\173"
	"\023\004\155\035\210\055\375\244\170\115\117\131\007\356\310\104"
	"\165\364\355\110\307\157\325\227\025\351\051\125\224\147\011\011"
	"\302\233\373\016\173\070\200\354\212\036\037\072\134\361\102\362"
	"\233\262\053\214\204\110\111\070\276\175\236\046\215\123\022\255"
	"\160\175\375\343\202\267\257\331\155\132\010\030\205\213\047\244"
	"\110\033\001\007\327\315\141\240\126\012\151\111\364\046\072\102"
	"\210\044\226\326\246\321\305\061\026\007\371\232\124\323\205\126"
	"\044\166\232\112\257\072\044\011\007\313\001\377\214\235\044\311"
	"\106\255\040\353\014\005\041\345\242\221\201\114\257\216\110\375"
	"\040\175\153\076\070\202\337\153\363\176\041\131\155\231\120\156"
	"\243\060\022\021\123\353\323\052\030\004\021\125\310\224\323\151"
	"\174\144\026\332\106\222\314\305\100\063\322\101\243\145\371\176"
	"\376\324\047\313\375\175\174\233\215\335\351\227\327\346\153\243"
	"\375\117\333\055\073\366\265\334\215\052\335\165\315\322\253\277"
	"\334\013\004\270\047\170\374\305\311\205\336\003\105\366\375\041"
	"\212\210\250\363\113\306\257\031\155\345\203\071\045\211\305\215"
	"\150\332\355\322\107\041\155\310\314\241\334\134\170\130\114\131"
	"\256\272\125\043\064\021\037\200\305\035\237\153\152\161\122\357"
	"\341\032\074\116\311\362\014\113\001\350\151\204\331\000\347\262"
	"\174\110\345\200\162\160\003\322\030\062\331\064\372\356\136\160"
	"\137\101\143\033\321\306\214\115\136\326\344\167\321\101\071\237"
	"\156\164\105\356\272\315\270\115\362\132\067\016\117\336\304\272"
	"\350\121\121\353\145\134\274\150\263\245\221\365\366\103\024\261"
	"\013\217\357\263\316\350\301\102\226\263\260\146\276\355\017\162"
	"\270\140\303\221\123\145\001\265\353\330\247\225\141\137\137\105"
	"\310\212\124\051\217\310\163\032\027\035\011\047\362\213\123\141"
	"\331\012\322\011\311\363\133\041\244\333\204\173\301\167\074\257"
	"\237\265\245\043\264\030\146\275\351\117\362\123\322\347\337\160"
	"\250\153\071\266\202\326\351\013\331\126\031\254\123\214\074\201"
	"\032\107\107\013\044\214\134\213\035\223\221\325\326\372\212\170"
	"\344\073\123\057\366\167\042\352\225\064\215\236\032\074\103\110"
	"\233\207\224\221\113\172\246\122\374\212\150\167\246\001\025\137"
	"\243\234\335\234\041\113\340\356\272\001\057\015\311\227\214\213"
	"\003\064\210\176\373\126\263\132\302\242\261\264\152\365\255\117"
	"\001\060\061\100\344\003\275\133\366\216\306\045\252\051\037\032"
	"\367\312\371\334\364\027\210\335\240\136\130\111\176\052\142\147"
	"\352\135\273\212\040\027\314\060\002\277\135\372\156\113\367\007"
	"\363\123\134\231\000\257\317\103\375\052\360\140\357\275\143\075"
	"\006\204\356\125\142\106\037\362\372\354\215\217\224\046\360\033"
	"\102\215\135\033\173\062\216\117\351\162\027\310\024\041\272\141"
	"\375\240\303\251\332\331\063\101\307\115\142\113\131\031\173\074"
	"\073\050\146\206\334\362\061\312\257\065\156\336\351\001\226\174"
	"\067\351\344\221\211\003\027\132\202\307\371\023\206\044\152\043"
	"\063\263\352\054\317\332\244\351\054\050\371\221\201\324\203\032"
	"\054\221\354\055\050\143\321\260\212\134\125\213\027\176\365\374"
	"\343\166\114\120\170\232\116\152\310\063\120\120\375\263\265\172"
	"\355\004\245\016\356\330\274\073\224\345\233\143\165\131\016\240"
	"\036\163\267\160\214\223\332\262\052\237\016\261\157\025\355\354"
	"\321\253\200\330\273\160\226\352\334\123\134\202\236\071\007\311"
	"\070\002\227\306\012\070\327\222\132\042\307\305\264\200\265\151"
	"\036\106\073\011\336\063\356\313\376\311\306\055\237\303\205\225"
	"\370\325\236\250\242\213\305\027\147\323\353\022\104\246\063\005"
	"\120\155\216\124\312\352\152\112\110\101\327\124\314\210\334\262"
	"\103\055\175\016\206\215\347\072\306\044\163\236\277\240\037\301"
	"\253\132\371\103\305\263\121\015\334\367\175\227\364\157\354\240"
	"\153\111\231\070\106\167\270\111\060\007\024\062\250\370\370\340"
	"\244\030\136\372\045\273\061\042\141\221\176\024\377\157\126\223"
	"\130\124\227\231\046\210\050\033\050\145\267\027\042\172\055\325"
	"\152\131\264\156\055\164\160\146\100\270\022\125\014\022\045\111"
	"\153\366\126\177\361\220\317\016\130\266\154\175\313\363\217\066"
	"\036\024\151\112\163\352\336\041\306\203\000\053\161\000\306\036"
	"\106\336\070\110\033\202\060\207\001\171\165\236\054\373\324\160"
	"\301\303\367\042\070\044\177\277\275\243\367\374\151\156\200\130"
	"\054\037\336\014\277\263\310\250\154\024\124\123\355\067\125\002"
	"\230\204\202\326\040\253\304\046\341\204\314\016\331\143\010\117"
	"\206\233\254\024\005\145\214\165\076\365\232\151\357\301\270\312"
	"\020\134\341\053\027\256\330\343\267\247\122\341\221\036\356\306"
	"\056\240\134\301\370\326\031\360\076\225\172\340\250\344\132\133"
	"\237\235\225\173\025\215\235\370\224\323\137\117\007\223\361\060"
	"\163\362\054\135\373\077\340\366\146\106\226\021\263\036\001\207"
	"\226\212\211\134\162\271\024\363\117\163\102\133\312\224\363\231"
	"\330\255\340\070\364\277\375\273\274\004\146\123\077\307\251\277"
	"\326\277\160\210\053\243\244\071\023\166\240\036\040\203\016\135"
	"\162\044\023\317\025\075\131\341\141\230\264\265\054\001\110\160"
	"\270\012\366\133\040\315\304\315\166\015\252\202\375\242\042\355"
	"\031\040\075\277\102\164\342\144\022\035\076\125\017\361\247\200"
	"\103\270\172\211\223\205\336\166\203\367\266\040\112\334\222\221"
	"\344\034\030\140\167\335\150\005\156\225\050\305\007\064\243\242"
	"\300\242\174\357\124\314\055\221\102\160\073\064\017\234\135\175"
	"\313\334\351\113\245\064\134\004\141\375\171\265\125\215\177\034"
	"\352\100\335\311\223\265\001\241\063\161\027\241\136\161\310\374"
	"\075\341\364\100\306\310\377\240\362\135\104\177\046\237\113\301"
	"\304\371\302\176\313\005\277\030\002\030\326\030\033\074\173\137"
	"\102\230\152\356\242\301\207\242\144\312\240\301\005\331\356\264"
	"\142\133\125\327\241\164\142\231\006\006\325\172\200\063\316\160"
	"\127\373\263\027\132\277\347\244\263\177\076\006\274\054\113\237"
	"\031\141\272\376\305\330\265\246\055\237\204\166\003\106\012\176"
	"\346\371\045\374\173\066\045\020\345\345\216\230\343\074\073\060"
	"\365\330\063\252\367\053\040\252\355\136\005\301\073\054\121\256"
	"\220\251\304\317\115\233\142\337\357\146\300\225\076\017\046\045"
	"\345\027\044\046\221\354\345\245\074\003\137\212\255\206\124\016"
	"\030\353\374\333\247\361\230\307\212\161\207\360\301\241\352\366"
	"\040\157\166\333\024\224\037\247\243\350\303\134\356\132\172\016"
	"\347\030\103\351\233\164\232\141\023\303\307\012\243\026\077\360"
	"\135\224\362\022\317\076\061\054\303\040\177\363\133\227\364\326"
	"\242\351\237\300\250\103\346\033\263\133\354\230\263\310\321\254"
	"\236\154\264\216\201\000\357\021\266\120\117\102\256\157\361\107"
	"\321\270\375\373\135\171\246\162\351\063\313\172\326\315\365\032"
	"\130\007\302\343\234\332\354\045\121\244\315\255\015\255\357\136"
	"\235\012\132\266\117\244\174\252\132\007\115\126\307\315\250\341"
	"\076\227\074\364\010\077\116\160\076\252\152\212\377\274\200\023"
	"\303\141\077\337\206\314\033\143\103\221\370\254\217\162\244\026"
	"\106\130\052\224\145\153\142\176\244\024\135\153\053\117\147\270"
	"\270\231\230\362\027\134\366\310\350\266\065\027\245\254\203\061"
	"\357\372\162\250\113\200\037\352\300\225\242\116\047\173\023\204"
	"\152\052\115\272\055\271\373\353\270\334\020\073\011\302\333\334"
	"\356\016\255\231\166\277\142\303\165\230\373\044\152\037\023\237"
	"\267\320\124\064\127\052\211\140\306\016\010\065\062\043\153\073"
	"\022\366\142\323\213\261\370\227\116\351\043\071\200\014\307\201"
	"\227\206\040\247\176\357\311\235\071\175\211\013\162\241\132\021"
	"\234\217\264\327\267\012\304\242\013\101\101\327\033\036\166\306"
	"\050\253\340\230\120\025\166\232\026\333\113\336\154\336\373\262"
	"\321\101\252\340\372\267\372\231\074\060\337\144\327\176\363\262"
	"\073\341\032\155\273\076\112\354\220\206\301\001\350\320\233\117"
	"\067\221\352\140\004\063\225\363\253\325\046\213\342\243\317\354"
	"\155\251\077\025\240\345\363\332\050\311\122\163\206\353\355\334"
	"\102\275\314\364\020\037\002\052\230\062\104\174\232\266\230\242"
	"\150\377\201\141\056\257\017\153\257\025\114\366\256\102\277\203"
	"\352\371\330\245\030\335\156\151\311\103\147\206\265\373\232\366"
	"\343\157\316\010\100\341\223\174\110\262\347\372\042\067\111\246"
	"\217\123\251\024\230\325\111\261\226\356\332\337\244\065\274\165"
	"\063\320\217\321\131\040\324\357\217\266\170\351\173\157\052\340"
	"\071\260\042\202\251\147\314\254\063\277\021\137\042\375\065\374"
	"\011\067\273\137\371\177\040\333\300\012\311\233\033\030\001\040"
	"\345\375\075\336\315\122\070\005\022\277\251\372\317\277\261\113"
	"\113\114\301\236\317\136\176\316\046\306\056\012\140\310\275\327"
	"\001\265\345\162\141\315\135\303\117\111\273\353\045\001\130\273"
	"\176\363\204\231\157\321\244\117\224\023\114\132\315\172\146\137"
	"\255\353\132\221\122\343\002\137\165\240\042\107\075\130\346\367"
	"\247\156\271\171\142\316\320\177\315\124\106\245\063\267\353\355"
	"\357\251\031\373\324\331\027\244\302\301\237\212\351\165\006\214"
	"\333\241\207\036\076\124\213\047\312\343\215\067\052\304\221\303"
	"\334\200\301\147\341\262\344\201\034\370\063\267\052\204\316\106"
	"\121\003\040\124\376\134\316\364\303\330\205\222\122\341\075\052"
	"\103\111\355\217\110\072\005\253\050\321\012\270\114\330\045\064"
	"\101\141\204\043\256\074\103\161\124\035\376\146\312\155\016\242"
	"\374\222\344\166\021\027\275\147\264\311\345\140\215\060\110\066"
	"\164\160\032\136\067\221\216\215\247\371\052\333\017\026\117\310"
	"\067\064\325\374\000\203\346\133\263\352\306\152\341\354\151\040"
	"\212\364\114\327\067\300\304\122\012\242\261\202\132\247\370\360"
	"\152\327\305\330\241\244\044\150\172\010\012\367\361\147\267\246"
	"\250\077\303\307\101\315\301\123\256\230\101\204\044\160\221\310"
	"\277\064\070\305\201\323\130\236\154\016\055\207\162\344\315\022"
	"\206\016\266\330\364\256\202\312\007\275\317\003\206\225\061\255"
	"\306\342\321\177\267\320\270\144\215\166\374\055\001\123\262\026"
	"\252\371\106\065\215\343\013\020\222\041\135\065\174\254\100\233"
	"\316\022\111\062\144\116\123\006\360\345\115\376\164\070\043\316"
	"\237\311\177\142\371\160\355\062\000\013\316\322\227\173\021\245"
	"\041\077\326\231\252\341\325\075\075\056\010\126\050\321\331\011"
	"\267\240\003\363\201\320\014\110\130\160\323\066\341\256\171\350"
	"\253\131\314\335\323\041\003\050\062\017\077\330\112\015\232\343"
	"\312\157\202\364\267\144\147\031\026\325\211\301\153\106\164\041"
	"\177\104\142\316\101\205\122\234\202\152\352\033\256\132\043\041"
	"\146\131\056\056\136\254\151\351\111\332\127\071\130\276\315\015"
	"\364\356\226\220\271\036\253\315\150\131\204\220\050\057\066\251"
	"\333\041\027\376\227\203\274\042\256\026\051\122\212\003\252\004"
	"\302\351\332\216\362\103\351\231\257\324\264\122\124\140\322\105"
	"\207\050\236\045\350\244\174\331\246\003\044\356\124\320\337\316"
	"\236\173\063\374\050\070\126\313\270\327\104\214\246\010\052\060"
	"\126\255\063\034\116\150\206\214\024\113\301\261\051\207\000\022"
	"\247\127\122\135\377\146\244\033\135\212\153\021\303\334\005\143"
	"\150\274\375\026\021\013\155\267\134\212\002\224\203\320\064\170"
	"\127\137\251\352\340\163\275\164\020\231\140\145\107\042\010\202"
	"\364\324\175\203\003\007\260\231\350\230\342\130\176\206\373\044"
	"\015\213\225\175\227\154\340\024\065\373\303\304\051\325\023\257"
	"\011\323\006\364\102\201\242\216\231\042\310\030\176\140\103\151"
	"\324\134\015\156\207\210\272\355\274\005\265\141\206\217\351\243"
	"\142\024\350\260\127\305\226\367\336\004\140\173\321\215\162\166"
	"\300\341\257\046\056\204\074\324\114\000\352\071\123\046\307\370"
	"\263\077\064\041\131\055\361\237\062\031\232\057\252\100\275\157"
	"\250\127\351\140\013\115\370\357\140\124\266\342\323\333\350\045"
	"\150\134\114\343\224\354\146\003\250\233\252\310\022\365\153\217"
	"\025\051\357\233\260\173\277\373\003\237\274\321\321\022\067\045"
	"\205\063\345\200\171\257\031\370\113\104\315\222\333\201\276\170"
	"\364\015\204\253\156\153\020\005\022\156\176\372\132\030\202\264"
	"\007\205\213\342\102\322\367\124\007\266\263\221\275\040\122\343"
	"\025\256\320\026\300\364\333\346\353\150\230\007\000\075\303\162"
	"\056\060\141\217\154\061\025\044\164\372\313\025\327\376\356\163"
	"\121\132\316\151\204\320\370\041\151\316\111\373\206\174\046\270"
	"\130\117\227\264\334\221\271\270\015\045\325\332\030\317\141\223"
	"\024\121\236\274\302\374\010\117\173\107\055\330\141\340\365\103"
	"\210\240\176\055\277\046\112\300\077\042\330\030\214\260\274\347"
	"\107\367\117\252\366\243\227\037\131\216\365\162\036\135\253\304"
	"\164\355\076\174\345\112\017\344\252\300\252\320\221\001\236\212"
	"\252\230\205\053\142\202\353\076\164\046\315\217\353\044\335\000"
	"\140\061\107\250\250\320\136\166"
#define      date_z	1
#define      date	((&data[4002]))
	"\215"
#define      inlo_z	3
#define      inlo	((&data[4003]))
	"\107\225\065"
#define      tst2_z	19
#define      tst2	((&data[4006]))
	"\114\373\136\127\120\116\361\360\200\317\203\315\221\326\247\111"
	"\365\145\320\364\120"
#define      lsto_z	1
#define      lsto	((&data[4027]))
	"\337"
#define      shll_z	8
#define      shll	((&data[4029]))
	"\066\124\362\061\062\320\303\334\057\216\177"
#define      rlax_z	1
#define      rlax	((&data[4039]))
	"\374"
#define      xecc_z	15
#define      xecc	((&data[4041]))
	"\315\052\033\322\044\020\222\365\174\173\031\257\321\312\243\023"
	"\134\351\301"
#define      tst1_z	22
#define      tst1	((&data[4062]))
	"\037\321\053\046\000\220\046\113\016\276\255\206\353\005\017\232"
	"\022\010\030\301\135\263\316\121\201\005\151\231"
#define      chk1_z	22
#define      chk1	((&data[4087]))
	"\130\146\172\345\345\110\107\024\150\131\117\071\005\317\150\134"
	"\065\315\127\270\027\043\154\340\311\245\053"
#define      opts_z	1
#define      opts	((&data[4114]))
	"\153"
#define      msg2_z	19
#define      msg2	((&data[4115]))
	"\075\156\022\356\015\306\121\315\145\033\211\243\255\057\111\056"
	"\063\326\115\175\126\125\166"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
